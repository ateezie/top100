(function(){function m(e){if("content"in document.createElement("template"))return e.content;var a=document.createDocumentFragment(),t=e.childNodes;for(i=0;i<t.length;i++)a.appendChild(t[i].cloneNode(!0));return a}function p(e,a){var t=m(a).cloneNode(!0),u=t.querySelector(".modal-title").textContent;t.querySelector(".modal-title").textContent=u.replace("{{subject}}",e.subject),t.querySelector(".notification-description").textContent=e.description;var c=t.querySelector(".follow-notify-form");c.action=__tnt.scrubUrl("/search/savedsearch/save/"+e.params),c.dataset.authorId=e.author_id,c.dataset.userUrl=__tnt.scrubUrl(e.user_url);var d=t.querySelector(".follow-notify-form a").href;return t.querySelector(".follow-notify-form a").href=__tnt.scrubUrl(d),t.querySelector(".input-notification-name").value=e.name,document.importNode(t,!0)}function y(){$("#follow-this-modal").modal({show:!1});for(var e=document.querySelectorAll(".followed-notify-btn"),a=0;a<e.length;a++)e[a].tagName=="A"?e[a].style.display="inline":e[a].tagName=="BUTTON"&&(e[a].disabled=!1);document.addEventListener("click",function(d){if(d.target.closest(".followed-notify-btn")){d.preventDefault();var o=d.target.closest(".followed-notify-btn");$("#follow-this-modal").modal("show");var s=document.getElementById("follow-this-modal"),n;if(__tnt.user.loggedIn){var f={subject:o.dataset.subject,description:o.dataset.description,params:o.dataset.params,name:o.dataset.name,author_id:o.dataset.authorId,user_url:o.dataset.userUrl};n=document.getElementById("follow-this-modal-logged-in");var v=p(f,n);s.replaceChild(v,s.firstElementChild)}else{n=document.getElementById("follow-this-modal-logged-out"),s.replaceChild(m(n).cloneNode(!0),s.firstElementChild);for(var r=s.querySelectorAll("a"),l=0;l<r.length;l++)r[l].href=__tnt.scrubUrl(r[l].href),r[l].href.indexOf(encodeURIComponent("?"))<0?r[l].href+=encodeURIComponent("?followid="+o.id):r[l].href+=encodeURIComponent("&followid="+o.id)}}});var t=document.getElementById("follow-this-modal");t.addEventListener("submit",function(d){if(d.preventDefault(),d.target.tagName=="FORM"){let r=function(l){setTimeout(function(){s.querySelector(".tnt-svg").style.display="none",l.style.display="block",setTimeout(function(){l.style.transition="opacity 400ms ease-in-out",l.style.opacity=0,l.addEventListener("transitionend",function h(){this.style.display="none",this.removeEventListener("transitionend",h)})},2500)},2e3)};var v=r,o=d.target,s=o.querySelector(".follow-btn");s.querySelector(".tnt-svg").style.display="inline-block",s.disabled=!0;var n=new XMLHttpRequest,f=o.action+"&title="+o.title.value;n.open("POST",f,!0),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded; charset=UTF-8"),n.setRequestHeader("X-Requested-With","XMLHttpRequest"),n.onreadystatechange=function(){n.readyState===4&&(n.status===200?(r(t.querySelector(".alert-success")),o.dataset.authorId&&__tnt.trackEvent({network:"Site",socialAction:"Follow",url:o.dataset.userUrl+"profile/"+o.dataset.authorId})):r(t.querySelector(".alert-danger")))},n.send()}});var u=new URLSearchParams(window.location.search),c=u.get("followid");c&&document.getElementById(c)&&document.getElementById(c).click()}document.readyState=="loading"?document.addEventListener("DOMContentLoaded",function(){y()}):y()})();
//# sourceMappingURL=tnt.followed.notifications.5c3f8754f8cc2a7e270984c98de1d1c9.js.map
