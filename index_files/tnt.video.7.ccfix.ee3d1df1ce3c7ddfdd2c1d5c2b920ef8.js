window.__tnt||(window.__tnt={}),typeof NodeList.prototype.forEach!="function"&&(NodeList.prototype.forEach=Array.prototype.forEach),__tnt.video||(__tnt.video={}),__tnt.video.blox||(__tnt.video.blox={}),__tnt.video.plugins||(__tnt.video.plugins={}),__tnt.video.advertising||(__tnt.video.advertising=function(e){__tnt.log("No video ad callback configured.")}),typeof window.CustomEvent=="function"?(window.videoReady=new CustomEvent("tntVideoReady"),window.videoEnded=new CustomEvent("tntVideoEnded")):(window.videoReady=document.createEvent("Event"),window.videoEnded=document.createEvent("Event"),videoReady.initEvent("tntVideoReady",!0,!0,{}),videoEnded.initEvent("tntVideoEnded",!0,!0,{})),__tnt.video.mimetype=function(e){var n="video/mp4";return typeof e=="string"&&(e.match(/\.flv/)!=null?n="video/x-flv":e.match(/\.m3u8/)!=null&&(n="application/x-mpegURL",videojs.browser.IS_ANY_SAFARI&&(n="application/vnd.apple.mpegurl"))),n},__tnt.video.getMarker=function(e,n){__tnt.user.loggedIn&&e.el_.dataset.premium&&fetch(__tnt.scrubUrl("/tncms/video/get_marker?asset_id="+e.el_.dataset.uuid)).then(function(i){if(i.status!==200){__tnt.log("Error. Status Code: "+i.status);return}i.json().then(function(o){e.currentTime(o.seconds),__tnt.video.blox.players[e.id()].resumeAt=o.seconds,typeof n=="function"&&n(e,o)})}).catch(function(i){__tnt.log("Fetch Error: ",i)})},__tnt.video.setMarker=function(e){var n=Math.floor(e.currentTime()),i=new XMLHttpRequest;if(__tnt.user.loggedIn&&e.el_.dataset.premium&&!__tnt.video.blox.players[e.id()].adPlaying)if(e.remainingTime()<=15){__tnt.video.clearMarker(e);return}else n&&(__tnt.video.blox.players[e.id()].reported_pos=n,i.open("post",__tnt.scrubUrl("/tncms/video/set_marker/")),i.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),i.onreadystatechange=function(){i.readyState===4&&i.status!==200&&__tnt.log("Request failed "+i.status)},i.send(encodeURI("asset_id="+e.el_.dataset.uuid+"&seconds="+n)))},__tnt.video.videoDataEvent=function(e,n){var i="",o="video",t="",s="",a=Math.floor(e.currentTime()),d=Math.round(100-(e.el_.dataset.duration-a)/e.el_.dataset.duration*100),l=!1,r="false";if((!e.el_.dataset.duration||e.el_.dataset.duration=="")&&(r="true",d=""),d>=5&&d<=10?(d=10,l=!0):d>=20&&d<=25?(d=25,l=!0):d>=45&&d<=50?(d=50,l=!0):d>=70&&d<=75?(d=75,l=!0):d>=95&&d<=100&&(d=100),n=="video_paused")i="video_paused",t="video paused",s=e.el_.dataset.title+":"+e.el_.dataset.uuid,a=e.el_.dataset.duration/100*d;else if(n=="video_resumed")i="video_resumed",t="video resumed",s=e.el_.dataset.title+":"+e.el_.dataset.uuid,a=e.el_.dataset.duration/100*d;else if(a<=1)i="video_start",t="video start",s=e.el_.dataset.title+":"+e.el_.dataset.uuid,a=0;else if(d==100)i="video_complete",t="video ended",s=e.el_.dataset.title+":"+e.el_.dataset.uuid,a=e.el_.dataset.duration;else if(l)i="video_progress",t="video progress",s=d+"%:"+e.el_.dataset.title+":"+e.el_.dataset.uuid,a=e.el_.dataset.duration/100*d;else return;var _=new CustomEvent("tntVideoData",{detail:{video_uuid:e.el_.dataset.uuid,video_title:e.el_.dataset.title,video_provider:e.el_.dataset.provider,video_duration:e.el_.dataset.duration,video_url:e.currentSrc(),video_current_time:Math.round(a),video_progress:d,visible:e.el_.dataset.visible}});dispatchEvent(_),console.log(_.detail);try{dataLayer.push({event:"tncms.event.trigger","tncms.event.trigger.category":o,"tncms.event.trigger.action":t,"tncms.event.trigger.label":s,"tncms.event.trigger.value":"1","tncms.event.trigger.name":i,"tncms.event.trigger.video_uuid":e.el_.dataset.uuid,"tncms.event.trigger.video_title":e.el_.dataset.title,"tncms.event.trigger.video_provider":e.el_.dataset.provider,"tncms.event.trigger.video_url":e.currentSrc(),"tncms.event.trigger.video_streaming":r,"tncms.event.trigger.video_duration":e.el_.dataset.duration,"tncms.event.trigger.video_current_time":Math.round(a),"tncms.event.trigger.video_percent":d,"tncms.event.trigger.visible":e.el_.dataset.visible})}catch{console.debug("%c dataLayer is not defined","color: #990000")}},__tnt.video.clearMarker=function(e){if(__tnt.user.loggedIn&&e.el_.dataset.premium){var n=new XMLHttpRequest;n.open("post",__tnt.scrubUrl("/tncms/video/clear_marker")),n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.onreadystatechange=function(){n.readyState===4&&n.status!==200&&__tnt.log("Request failed "+n.status)},n.send(encodeURI("asset_id="+e.el_.dataset.uuid))}},__tnt.video.pause=function(e){var n=__tnt.video.blox.players[e.id()].playing;__tnt.video.nielsen&&__tnt.video.nielsen.stop(e),e.remainingTime()>.2&&e.currentTime()>.2&&n&&(__tnt.video.videoDataEvent(e,"video_paused"),__tnt.video.blox.players[e.id()].paused=!0)},__tnt.video.register=function(e){__tnt.video.blox.players||(__tnt.video.blox.players=[]),typeof __tnt.video.blox.players[e.id()]>"u"&&(__tnt.video.blox.players.push(e.id()),__tnt.video.blox.players[e.id()]={src:e.currentSrc(),playing:!1,played:!1,playLogged:!1,paused:!1,stalled:0,lastFrame:0,endcard:!0,endcardDisplayed:!1,adPlaying:!1,resumeAt:0,activeTextTrack:null})},__tnt.video.decompose=function(e){var n=[];__tnt.video.blox.players.forEach(function(i){i!=e&&(n.push(i),n[i]=__tnt.video.blox.players[i])}),__tnt.video.blox.players=n},__tnt.video.callback||(__tnt.video.callback=function(e){var n=function(i){__tnt.video.blox.players[e.id()].played=!0;var o=document.getElementById(e.id()+"-engagement");if(__tnt.video.clearMarker(e),__tnt.log("Player - Ended - passed playing check"),__tnt.video.blox.players[e.id()].playing=!1,__tnt.video.blox.players[e.id()].playLogged=!1,o){if(__tnt.log("Player - Displaying end card"),__tnt.log("Player - Running engagement module"),o.querySelectorAll(".engagement-container .engagement-item").length)o.querySelectorAll(".engagement-container .engagement-item").length?(o.classList.remove("hide"),o.style.display="block"):(o.style.display="block",e.bigPlayButton.el().style.display="block",o.querySelect(".engagement-spinner").style.display="none");else{var t=e.id().replace("video-player-","");__tnt.engagement&&__tnt.engagement.assets.length&&t&&typeof __tnt.engagement.assets[t].populate()=="function"&&(e.bigPlayButton.el().style.display="none",e.controlBar.el().style.display="none",o.style.display="none",o.querySelector(".engagement-spinner").style.display="none",e.currentTime(0),e.trigger("loadstart"))}__tnt.video.blox.players[e.id()].endcardDisplayed=!0,o.querySelector(".endcard-replay a").addEventListener("click",function(){o.style.display="none",e.play()})}e.el().dispatchEvent(videoEnded),__tnt.video.nielsen&&!__tnt.video.nielsen.ended&&__tnt.video.nielsen.end(e)};__tnt.video.register(e),e.on("__tnt.video.initialize",function(i){__tnt.video.blox.players[e.id()].playing=!1,__tnt.video.blox.players[e.id()].paused=!1,__tnt.video.blox.players[e.id()].reported_pos=!1,__tnt.video.blox.players[e.id()].reported_percent=0,__tnt.video.getMarker(e),__tnt.video.nielsen&&__tnt.video.nielsen.sdkinit(e);var o=function(s,a){s[0].isIntersecting?e.el_.dataset.visible="true":e.el_.dataset.visible="false"},t=new IntersectionObserver(o);t.observe(e.el_),i.target.closest(".tn-mediaplayer")&&i.target.closest(".tn-mediaplayer").dataset.autoAdvance&&setTimeout(function(){e.play()},100)}),e.on("timeupdate",function(i){var o=Math.floor(e.currentTime()),t=Math.round(100-(e.el_.dataset.duration-o)/e.el_.dataset.duration*100);t>=5&&t<=10?t=10:t>=20&&t<=25?t=25:t>=45&&t<=50?t=50:t>=70&&t<=75?t=75:t>=95&&t<=100&&(t=100),(t==10||t==25||t==50||t==75||t==100)&&__tnt.video.blox.players[e.id()].reported_percent<t&&(__tnt.video.videoDataEvent(e),__tnt.video.blox.players[e.id()].reported_percent=t),o%10==0&&o!=__tnt.video.blox.players[e.id()].reported_pos&&(__tnt.video.blox.players[e.id()].reported_pos=o,__tnt.video.setMarker(e))}),e.on("play",function(i){var o=__tnt.video.blox.players[e.id()].playing,t=__tnt.video.blox.players[e.id()].paused,s=e.id().replace("video-player-",""),a=document.getElementById(e.id()+"-engagement"),d=__tnt.video.blox.players[e.id()].endcardDisplayed;if(__tnt.video.setMarker(e),t)__tnt.video.videoDataEvent(e,"video_resumed"),__tnt.video.blox.players[e.id()].paused=!1;else if(!o){if(__tnt.video.blox.players[e.id()].playing=!0,__tnt.video.blox.players.length>1)for(var l=0;l<__tnt.video.blox.players.length;l++){var r=__tnt.video.blox.players[l];__tnt.video.blox.players[r]&&e.id()!=r&&__tnt.video.blox.players[r].playing&&videojs(r)&&videojs(r).pause()}e.contentEl().querySelector(".vjs-loading-spinner").style.display="none",e.posterImage.el().style.display="none",__tnt.video.blox.players[e.id()].playLogged||(__tnt.video.blox.players[e.id()].playLogged=!0,__tnt.video.videoDataEvent(e)),e.contentEl()&&a&&e.contentEl().appendChild(a),a&&__tnt.engagement&&!d&&(__tnt.log("Player - On Play - Pre-populating end card"),__tnt.engagement.assets&&__tnt.engagement.assets[s]&&typeof __tnt.engagement.assets[s].populate()=="function"&&__tnt.engagement.assets[s].populate()),d&&(document.getElementById(e.id()+"-engagement").style.display="none")}__tnt.video.nielsen&&__tnt.video.nielsen.start(e)}),e.on("pause",function(i){var o=e.el().closest(".tnt-video-container");o.getAttribute("data-live")=="true"&&!videojs.browser.IS_IOS?e.play():(__tnt.video.pause(e),__tnt.video.blox.players[e.id()].playing=!1)}),e.on("fullscreenchange",function(i){e.isFullscreen()?e.el().classList.add("is-fullscreen"):e.el().classList.remove("is-fullscreen")}),e.tech_.on("ended",n),e.on("ended",n),e.trigger("__tnt.video.initialize")}),__tnt.video.handleTags=function(e,n){for(var i=[],o={fluid:!0,plugins:__tnt.video.plugins,crossorigin:"anonymous",html5:{nativeTextTracks:!1,nativeAudioTracks:!1,nativeVideoTracks:!1,hls:{overrideNative:!0,handleManifestRedirects:!0,cacheEncryptionKeys:!0}}},t=0;t<e.length;t++){var s=e[t],a=document.createElement("div");s.setAttribute("controls","true");var d=["videojs","vjs-7","vjs-default-skin","vjs-big-play-centered","vjs-16-9"];d.forEach(function(l){s.classList.add(l)}),videojs(s,o,function(){i.push(this),player=this,typeof __tnt.video.advertising=="function"&&__tnt.video.advertising(player),(navigator.userAgent.indexOf("MSIE")!==-1||navigator.appVersion.indexOf("Trident/")>0||navigator.userAgent.indexOf("Edge/"))&&(document.getElementById(player.id()).style["padding-top"]="56.25%"),__tnt.video.callback(player),player.trigger("loadstart"),canAutoplay.video({inline:!0}).then(function(l){var r=document.getElementsByTagName("body")[0],_=s.id;_=_.replace("_html5_api","");var v=document.getElementById(_),g=_.replace("video-player-",""),f=r.classList.contains("blox-asset"),m=r.classList.contains("uuid-"+g),p=v.closest("#asset-video-primary"),b=v.closest(".tnt-media-autoplay");if(l.error!=null&&console.log(l.error),l.result===!0&&(f&&(m||p)||b))try{var u=new IntersectionObserver(function(c){c[0].intersectionRatio<=0||(!__tnt.video.blox.players[_].playing&&!__tnt.video.blox.players[player.id()].endcardDisplayed?__tnt.video.blox.players[_].played?u.disconnect():videojs(_).play():__tnt.video.blox.players[player.id()].endcardDisplayed&&u.disconnect())});u.observe(document.getElementById(_))}catch(c){console.log(c)}})})}typeof n=="function"&&n(i)},__tnt.video.legacy_no_template_support=function(){var e=document.querySelectorAll("video.tnt-video,audio.tnt-audio");if(e.length)for(var n=0;n<e.length;n++)e[n].closest("template")||__tnt.video.handleTags(e[n].parentElement.querySelectorAll("video.tnt-video,audio.tnt-audio"))},document.addEventListener("tntVideoReady",function(e){videojs.browser.IE_VERSION==null?__tnt.video.handleTags(document.querySelectorAll("video.tnt-video,audio.tnt-audio,video-js.tnt-video")):__tnt.video.legacy_no_template_support()}),document.addEventListener("DOMContentLoaded",function(e){setTimeout(function(){__tnt.video.vast||document.dispatchEvent(videoReady)},2500)});
//# sourceMappingURL=tnt.video.7.ccfix.ee3d1df1ce3c7ddfdd2c1d5c2b920ef8.js.map
